---
title: "Table S4.xlsx"
output: html_document
---



**Mention in thesis (for traceability):**

> Cluster annotation, i.e., assigning biological identities to clusters, is generally challenging and becomes particularly difficult in non-classical model organisms, due to the lack of dedicated reference databases. To facilitate this process, a comprehensive and manually curated marker reference had to be constructed. To this end, a planarian-specific marker reference table (Supplementary Table S4) was prepared by collecting lineage and subtype markers from published planarian scRNA-seq atlases and lineage studies, recording the original gene names and sources, and then mapping each marker to the gene identifiers used in this dissertation (the schMed_Pn annotation). For each entry, a general lineage label and a detailed population label were assigned, together with both a human-readable marker name and the corresponding SMESG gene ID used in the pre-processed Seurat object. Duplicates and naming variants were harmonized so that each marker was represented consistently across analyses, and supporting references were retained in the table to enable manual traceability.


- <a href="tables/Table%20S4.xlsx" download>Download original XLSX</a>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
tab_dir <- normalizePath(file.path('..','tables'), winslash='/', mustWork=TRUE)
fname <- "Table S4.xlsx"
path_abs <- file.path(tab_dir, fname)
```

```{r}
sheets <- tryCatch(readxl::excel_sheets(path_abs), error = function(e) character())
if (length(sheets) == 0) {
  htmltools::tags$em('(No readable sheets.)')
} else {
  blocks <- lapply(sheets, function(sh) {
    dat <- tryCatch(readxl::read_excel(path_abs, sheet = sh), error = function(e) NULL)
    if (is.null(dat)) {
      return(htmltools::tagList(
        htmltools::tags$h2(paste0('Sheet: ', sh)),
        htmltools::tags$em('(Could not read this sheet.)')
      ))
    }
    dt <- DT::datatable(as.data.frame(dat), rownames=FALSE, extensions=c('Buttons','Scroller'),
      options=list(pageLength=25, scrollX=TRUE, scrollY=520, scroller=TRUE, dom='Bfrtip',
        buttons=c('copy','csv','excel'), searchHighlight=TRUE))
    htmltools::tagList(
      htmltools::tags$h2(paste0('Sheet: ', sh)),
      dt
    )
  })
  htmltools::tagList(blocks)
}
```
